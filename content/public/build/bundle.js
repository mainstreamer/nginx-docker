var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode&&t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.data!==e&&(t.data=e)}let h;function $(t){h=t}function v(){if(!h)throw new Error("Function called outside component initialization");return h}function b(t){v().$$.on_mount.push(t)}function y(){const t=v();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const l=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,o,e),r}(e,n,{cancelable:o});return r.slice().forEach((e=>{e.call(t,l)})),!l.defaultPrevented}return!0}}const w=[],x=[];let T=[];const E=[],k=Promise.resolve();let A=!1;function _(t){T.push(t)}const C=new Set;let P=0;function S(){if(0!==P)return;const t=h;do{try{for(;P<w.length;){const t=w[P];P++,$(t),N(t.$$)}}catch(t){throw w.length=0,P=0,t}for($(null),w.length=0,P=0;x.length;)x.pop()();for(let t=0;t<T.length;t+=1){const e=T[t];C.has(e)||(C.add(e),e())}T.length=0}while(w.length);for(;E.length;)E.pop()();A=!1,C.clear(),$(t)}function N(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const O=new Set;let j;function I(){j={r:0,c:[],p:j}}function q(){j.r||o(j.c),j=j.p}function B(t,e){t&&t.i&&(O.delete(t),t.i(e))}function G(t,e,n,o){if(t&&t.o){if(O.has(t))return;O.add(t),j.c.push((()=>{O.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function L(t){t&&t.c()}function M(t,n,l,s){const{fragment:c,after_update:i}=t.$$;c&&c.m(n,l),s||_((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),i.forEach(_)}function z(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];T.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),T=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function F(t,e){-1===t.$$.dirty[0]&&(w.push(t),A||(A=!0,k.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(e,r,l,s,c,a,u,d=[-1]){const f=h;$(e);const m=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:r.target||f.$$.root};u&&u(m.root);let p=!1;if(m.ctx=l?l(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return m.ctx&&c(m.ctx[t],m.ctx[t]=r)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](r),p&&F(e,t)),n})):[],m.update(),p=!0,o(m.before_update),m.fragment=!!s&&s(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(i)}else m.fragment&&m.fragment.c();r.intro&&B(e.$$.fragment),M(e,r.target,r.anchor,r.customElement),S()}$(f)}class D{$destroy(){z(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}async function U(t,e={}){const n=localStorage.getItem("accessToken"),o={"Content-Type":"application/json"};n&&(o.Authorization=`Bearer ${n}`),e.headers={...o,...e.headers};try{return await fetch(t,e)}catch(t){throw console.error("Error in fetch:",t),t}}let V="https://capitals.tldr.icu",J=`${V}/capitals`,K=`${V}/api/tg/login`;function X(e){let n,o,r,l,a=H-e[0]+"";return{c(){n=u("div"),o=u("h4"),r=d("Time left: "),l=d(a),p(o,"class","svelte-1g389v9"),p(n,"class","localTimerContainer svelte-1g389v9")},m(t,e){c(t,n,e),s(n,o),s(o,r),s(o,l)},p(t,[e]){1&e&&a!==(a=H-t[0]+"")&&g(l,a)},i:t,o:t,d(t){t&&i(n)}}}let H=30;function Q(t,e,n){let{action:o}=e,r=0,l=((t=y())=>()=>{t("timerStopped",{data:r})})(),s=((t=y())=>()=>{t("timeout",{})})(),c=null;let i=()=>(console.log("timer started"),c=setInterval((()=>H-r>0?n(0,r+=1):a()),1e3));const a=()=>{u(),s()},u=()=>{l(),clearInterval(c)};var d;return d=()=>{u()},v().$$.on_destroy.push(d),t.$$set=t=>{"action"in t&&n(1,o=t.action)},t.$$.update=()=>{if(2&t.$$.dirty&&o)switch(o.action){case"start":n(0,r=0),console.log("start"),i();break;case"restart":n(0,r=0),console.log("restart");break;case"stop":u(),n(0,r=0),console.log("stop");break;default:console.log("default")}},[r,o]}class W extends D{constructor(t){super(),R(this,t,Q,X,l,{action:1})}}function Y(t,e,n){const o=t.slice();return o[21]=e[n],o}function Z(e){return{c:t,m:t,d:t}}function tt(t){let e,n,o,r,l,m,h,$,v,b,y,w,x,T,E,k,A,_,C,P,S,N,O,j,I,q=t[1].text+"",F=t[1].flag+"";b=new W({props:{action:t[4]}}),b.$on("timerStopped",t[9]),b.$on("timeout",t[10]);let R=t[3]&&nt(t),D=t[1].options,U=[];for(let e=0;e<D.length;e+=1)U[e]=at(Y(t,D,e));function V(t,e){return t[0]>0?dt:ut}let J=V(t),K=J(t);return{c(){e=u("div"),n=u("div"),o=d("Score: "),r=d(t[5]),l=f(),m=u("div"),h=d("Lives: "),$=d(t[6]),v=f(),L(b.$$.fragment),y=f(),w=u("div"),x=u("div"),T=d(q),E=f(),k=u("div"),A=d(F),_=f(),C=u("hr"),P=f(),S=u("div"),R&&R.c(),N=f();for(let t=0;t<U.length;t+=1)U[t].c();O=f(),j=u("center"),K.c(),p(e,"class","scoreBox svelte-1ri949t"),p(x,"class","question svelte-1ri949t"),p(k,"class","questionFlag svelte-1ri949t"),p(w,"class","questionContainer svelte-1ri949t"),p(S,"class","messageBox svelte-1ri949t")},m(t,i){c(t,e,i),s(e,n),s(n,o),s(n,r),s(e,l),s(e,m),s(m,h),s(m,$),c(t,v,i),M(b,t,i),c(t,y,i),c(t,w,i),s(w,x),s(x,T),s(w,E),s(w,k),s(k,A),c(t,_,i),c(t,C,i),c(t,P,i),c(t,S,i),R&&R.m(S,null),c(t,N,i);for(let e=0;e<U.length;e+=1)U[e]&&U[e].m(t,i);c(t,O,i),c(t,j,i),K.m(j,null),I=!0},p(t,e){(!I||32&e)&&g(r,t[5]),(!I||64&e)&&g($,t[6]);const n={};if(16&e&&(n.action=t[4]),b.$set(n),(!I||2&e)&&q!==(q=t[1].text+"")&&g(T,q),(!I||2&e)&&F!==(F=t[1].flag+"")&&g(A,F),t[3]?R?R.p(t,e):(R=nt(t),R.c(),R.m(S,null)):R&&(R.d(1),R=null),266&e){let n;for(D=t[1].options,n=0;n<D.length;n+=1){const o=Y(t,D,n);U[n]?U[n].p(o,e):(U[n]=at(o),U[n].c(),U[n].m(O.parentNode,O))}for(;n<U.length;n+=1)U[n].d(1);U.length=D.length}J===(J=V(t))&&K?K.p(t,e):(K.d(1),K=J(t),K&&(K.c(),K.m(j,null)))},i(t){I||(B(b.$$.fragment,t),I=!0)},o(t){G(b.$$.fragment,t),I=!1},d(t){t&&i(e),t&&i(v),z(b,t),t&&i(y),t&&i(w),t&&i(_),t&&i(C),t&&i(P),t&&i(S),R&&R.d(),t&&i(N),a(U,t),t&&i(O),t&&i(j),K.d()}}}function et(e){let n,o,r;return{c(){var t,l,s,c;n=u("p"),o=d("Error: "),r=d(e[2]),t=n,l="color",null==(s="red")?t.style.removeProperty(l):t.style.setProperty(l,s,c?"important":"")},m(t,e){c(t,n,e),s(n,o),s(n,r)},p(t,e){4&e&&g(r,t[2])},i:t,o:t,d(t){t&&i(n)}}}function nt(t){let e,n;function o(t,n){return 8&n&&(e=null),null==e&&(e=!!t[3].text.includes("GAME OVER")),e?rt:ot}let r=o(t,-1),l=r(t);return{c(){l.c(),n=d("")},m(t,e){l.m(t,e),c(t,n,e)},p(t,e){r===(r=o(t,e))&&l?l.p(t,e):(l.d(1),l=r(t),l&&(l.c(),l.m(n.parentNode,n)))},d(t){l.d(t),t&&i(n)}}}function ot(t){let e,n=t[3].text+"";return{c(){e=d(n)},m(t,n){c(t,e,n)},p(t,o){8&o&&n!==(n=t[3].text+"")&&g(e,n)},d(t){t&&i(e)}}}function rt(t){let e,n,o,r,l,a=t[3].text+"",m=t[3].stat+"";return{c(){e=u("marquee"),n=d(a),o=f(),r=u("div"),l=d(m),p(r,"class","smallerText svelte-1ri949t"),p(e,"behavior","alternate")},m(t,i){c(t,e,i),s(e,n),s(e,o),s(e,r),s(r,l)},p(t,e){8&e&&a!==(a=t[3].text+"")&&g(n,a),8&e&&m!==(m=t[3].stat+"")&&g(l,m)},d(t){t&&i(e)}}}function lt(e){let n;return{c(){n=d("Â ")},m(t,e){c(t,n,e)},p:t,d(t){t&&i(n)}}}function st(t){let e,n=t[21].flag+"";return{c(){e=d(n)},m(t,n){c(t,e,n)},p(t,o){2&o&&n!==(n=t[21].flag+"")&&g(e,n)},d(t){t&&i(e)}}}function ct(e){let n;return{c(){n=d("Â ")},m(t,e){c(t,n,e)},p:t,d(t){t&&i(n)}}}function it(t){let e,n=t[21].country+"";return{c(){e=d(n)},m(t,n){c(t,e,n)},p(t,o){2&o&&n!==(n=t[21].country+"")&&g(e,n)},d(t){t&&i(e)}}}function at(t){let e,n,o,l,a,h,$,v,b,y,w=t[21].option+"";function x(t,e){return t[3]?st:lt}let T=x(t),E=T(t);function k(t,e){return t[3]?it:ct}let A=k(t),_=A(t);return{c(){e=u("div"),n=u("div"),o=u("button"),l=d(w),a=f(),h=u("div"),E.c(),$=f(),v=u("div"),_.c(),p(o,"class","svelte-1ri949t"),p(n,"class","optionButton svelte-1ri949t"),p(h,"class","optionFlag svelte-1ri949t"),p(v,"class","optionText svelte-1ri949t"),p(e,"class","optionLineContainer svelte-1ri949t")},m(i,u){c(i,e,u),s(e,n),s(n,o),s(o,l),s(e,a),s(e,h),E.m(h,null),s(e,$),s(e,v),_.m(v,null),b||(y=m(o,"click",(function(){r(t[8](t[1].isoCode,t[21].option))&&t[8](t[1].isoCode,t[21].option).apply(this,arguments)})),b=!0)},p(e,n){t=e,2&n&&w!==(w=t[21].option+"")&&g(l,w),T===(T=x(t))&&E?E.p(t,n):(E.d(1),E=T(t),E&&(E.c(),E.m(h,null))),A===(A=k(t))&&_?_.p(t,n):(_.d(1),_=A(t),_&&(_.c(),_.m(v,null)))},d(t){t&&i(e),E.d(),_.d(),b=!1,y()}}}function ut(e){let n,r,l,s,a;return{c(){n=u("button"),n.textContent="GO AGAIN",r=f(),l=u("button"),l.textContent="BACK TO MAIN",p(n,"class","megabutton svelte-1ri949t")},m(t,o){c(t,n,o),c(t,r,o),c(t,l,o),s||(a=[m(n,"click",e[11]),m(l,"click",e[12])],s=!0)},p:t,d(t){t&&i(n),t&&i(r),t&&i(l),s=!1,o(a)}}}function dt(e){let n,o,r;return{c(){n=u("button"),n.textContent="GO NEXT",p(n,"class","megabutton svelte-1ri949t")},m(t,l){c(t,n,l),o||(r=m(n,"click",e[7]),o=!0)},p:t,d(t){t&&i(n),o=!1,r()}}}function ft(t){let e,n,o,r,l,a=!t[1]&&Z();const d=[et,tt],m=[];function g(t,e){return t[2]?0:t[1]?1:-1}return~(o=g(t))&&(r=m[o]=d[o](t)),{c(){e=u("div"),a&&a.c(),n=f(),r&&r.c(),p(e,"class","mainContainer")},m(t,r){c(t,e,r),a&&a.m(e,null),s(e,n),~o&&m[o].m(e,null),l=!0},p(t,[l]){t[1]?a&&(a.d(1),a=null):a||(a=Z(),a.c(),a.m(e,n));let s=o;o=g(t),o===s?~o&&m[o].p(t,l):(r&&(I(),G(m[s],1,1,(()=>{m[s]=null})),q()),~o?(r=m[o],r?r.p(t,l):(r=m[o]=d[o](t),r.c()),B(r,1),r.m(e,null)):r=null)},i(t){l||(B(r),l=!0)},o(t){G(r),l=!1},d(t){t&&i(e),a&&a.d(),~o&&m[o].d()}}}function mt(t,e,n){let{inProgress:o}=e,{timeTotal:r}=e,l=3,s=null,c=null,i=null,a=0,u=null,d=0,f=null;const m=async()=>{try{n(4,u={action:"start"}),n(3,i=null);const t=await U(`${J}`);if(!t.ok)throw new Error("Network response was not ok");n(1,s=await t.json()),g()}catch(t){n(2,c=t.message)}},p=t=>{!1===t.isCorrect?1===l?(n(0,l=0),h()):n(0,l--,l):(n(4,u={action:"stop"}),n(5,d++,d)),g()},g=()=>{l>=3?n(6,f="ðŸ‘¾ðŸ‘¾ðŸ‘¾"):2===l?n(6,f="ðŸ‘¾ðŸ‘¾âŒ"):1===l?n(6,f="ðŸ‘¾âŒâŒ"):0===l&&n(6,f="âŒâŒâŒ")},h=((t=y())=>()=>{t("triggerGameOver",{score:d}),n(3,i={text:"GAME OVER ðŸ‘¾",stat:`scored ${d} in ${r} sec`})})(),$=((t=y())=>()=>{t("updateTimeTotal",{data:a})})();return b((()=>m())),t.$$set=t=>{"inProgress"in t&&n(13,o=t.inProgress),"timeTotal"in t&&n(14,r=t.timeTotal)},[l,s,c,i,u,d,f,m,async(t,e)=>{try{n(4,u={action:"stop"}),e=btoa(e);const o=await U(`${J}/${t}/${e}`);if(!o.ok)throw new Error("Network response was not ok");n(3,i=await o.json()),p(i)}catch(t){n(2,c=t.message)}},t=>{a=t.detail.data,$()},()=>{n(3,i={text:"â° Time up"}),p({isCorrect:!1})},()=>{n(5,d=0),n(0,l=3),m()},()=>{n(13,o=!1),location.reload()},o,r]}class pt extends D{constructor(t){super(),R(this,t,mt,ft,l,{inProgress:13,timeTotal:14})}}function gt(e){let n;return{c(){n=u("div"),p(n,"id","telegram-login"),p(n,"class","telegram-login")},m(t,e){c(t,n,e)},p:t,i:t,o:t,d(t){t&&i(n)}}}function ht(t,e,n){let{onTelegramAuth:o}=e;return b((()=>{const t=document.createElement("script");t.src="https://telegram.org/js/telegram-widget.js?7",t.setAttribute("data-telegram-login","flagstestbot"),t.setAttribute("data-size","large"),t.setAttribute("data-radius","10"),t.setAttribute("data-request-access","write"),t.setAttribute("data-onauth","onTelegramAuth(user)"),t.async=!0,window.onTelegramAuth=o,document.getElementById("telegram-login").appendChild(t)})),t.$$set=t=>{"onTelegramAuth"in t&&n(0,o=t.onTelegramAuth)},[o]}class $t extends D{constructor(t){super(),R(this,t,ht,gt,l,{onTelegramAuth:0})}}function vt(t,e,n){const o=t.slice();return o[2]=e[n],o}function bt(t){let e,n=t[0],o=[];for(let e=0;e<n.length;e+=1)o[e]=yt(vt(t,n,e));return{c(){e=u("ol");for(let t=0;t<o.length;t+=1)o[t].c()},m(t,n){c(t,e,n);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null)},p(t,r){if(1&r){let l;for(n=t[0],l=0;l<n.length;l+=1){const s=vt(t,n,l);o[l]?o[l].p(s,r):(o[l]=yt(s),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},d(t){t&&i(e),a(o,t)}}}function yt(t){let e,n,o,r,l,a,m,h,$,v,b,y,w,x=t[2].userName+"",T=t[2].sessionTimer+"",E=t[2].score+"";return{c(){e=u("li"),n=u("tr"),o=u("td"),r=d(x),l=f(),a=u("td"),m=d("Time: "),h=d(T),$=f(),v=u("td"),b=d("Score: "),y=d(E),w=f(),p(o,"class","svelte-asgrlh"),p(a,"class","svelte-asgrlh"),p(v,"class","svelte-asgrlh")},m(t,i){c(t,e,i),s(e,n),s(n,o),s(o,r),s(n,l),s(n,a),s(a,m),s(a,h),s(n,$),s(n,v),s(v,b),s(v,y),s(e,w)},p(t,e){1&e&&x!==(x=t[2].userName+"")&&g(r,x),1&e&&T!==(T=t[2].sessionTimer+"")&&g(h,T),1&e&&E!==(E=t[2].score+"")&&g(y,E)},d(t){t&&i(e)}}}function wt(e){let n,o,r,l=e[0]&&bt(e);return{c(){n=u("div"),o=u("center"),o.textContent="Imagine beautiful landing page âœ¨",r=f(),l&&l.c(),p(n,"class","highScores svelte-asgrlh")},m(t,e){c(t,n,e),s(n,o),s(n,r),l&&l.m(n,null)},p(t,[e]){t[0]?l?l.p(t,e):(l=bt(t),l.c(),l.m(n,null)):l&&(l.d(1),l=null)},i:t,o:t,d(t){t&&i(n),l&&l.d()}}}function xt(t,e,n){let o=null;return(async()=>{console.log(`${J}/high-scores`);let t=await fetch(`${J}/high-scores`);if(!t.ok)throw new Error("Error fetching high scores");n(0,o=await t.json())})(),[o]}class Tt extends D{constructor(t){super(),R(this,t,xt,wt,l,{})}}function Et(e){let n,o,r,l,s;return n=new Tt({}),l=new $t({props:{onTelegramAuth:e[3]}}),{c(){L(n.$$.fragment),o=f(),r=u("center"),L(l.$$.fragment)},m(t,e){M(n,t,e),c(t,o,e),c(t,r,e),M(l,r,null),s=!0},p:t,i(t){s||(B(n.$$.fragment,t),B(l.$$.fragment,t),s=!0)},o(t){G(n.$$.fragment,t),G(l.$$.fragment,t),s=!1},d(t){z(n,t),t&&i(o),t&&i(r),z(l)}}}function kt(t){let e,n,o,r,l,a;return l=new pt({props:{timeTotal:t[1],inProgress:t[0]}}),l.$on("updateTimeTotal",t[2]),l.$on("triggerGameOver",t[4]),{c(){e=u("h4"),n=d("Time elapsed: "),o=d(t[1]),r=f(),L(l.$$.fragment),p(e,"class","svelte-1qyuyoi")},m(t,i){c(t,e,i),s(e,n),s(e,o),c(t,r,i),M(l,t,i),a=!0},p(t,e){(!a||2&e)&&g(o,t[1]);const n={};2&e&&(n.timeTotal=t[1]),1&e&&(n.inProgress=t[0]),l.$set(n)},i(t){a||(B(l.$$.fragment,t),a=!0)},o(t){G(l.$$.fragment,t),a=!1},d(t){t&&i(e),t&&i(r),z(l,t)}}}function At(t){let e,n,o,r;const l=[kt,Et],s=[];function a(t,e){return t[0]?0:1}return n=a(t),o=s[n]=l[n](t),{c(){e=u("div"),o.c()},m(t,o){c(t,e,o),s[n].m(e,null),r=!0},p(t,[r]){let c=n;n=a(t),n===c?s[n].p(t,r):(I(),G(s[c],1,1,(()=>{s[c]=null})),q(),o=s[n],o?o.p(t,r):(o=s[n]=l[n](t),o.c()),B(o,1),o.m(e,null))},i(t){r||(B(o),r=!0)},o(t){G(o),r=!1},d(t){t&&i(e),s[n].d()}}}function _t(t,e,n){let{name:o}=e,r=0,{inProgress:l=!1}=e,{finalScore:s=null}=e;return t.$$set=t=>{"name"in t&&n(5,o=t.name),"inProgress"in t&&n(0,l=t.inProgress),"finalScore"in t&&n(6,s=t.finalScore)},[l,r,t=>{n(1,r+=t.detail.data),console.log("TIME UPDATED",t.detail.data,r)},async t=>{try{const e=await fetch(`${K}?${new URLSearchParams(t)}`);if(!e.ok)throw new Error("Network response was not ok");let o=await e.json();localStorage.setItem("accessToken",o.token),n(0,l=!0)}catch(t){t.message}},t=>{U(`${J}/game-over`,{method:"POST",body:JSON.stringify({score:t.detail.score,sessionTimer:r})}),n(1,r=0)},o,s]}return new class extends D{constructor(t){super(),R(this,t,_t,At,l,{name:5,inProgress:0,finalScore:6})}}({target:document.body,props:{name:"Capitals quiz"}})}();
//# sourceMappingURL=bundle.js.map
